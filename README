# Performance tests for ClickHouse statistics

Compare:
no opt/old algo/new row/new granule

rows = 100.000.000

GRANULE = 8192

Uint64: u1, u2, u3, u4
Int32: i1, i2 
Strings: s1, s2, s3, heavy

u1 -> index % GRANULE
u2 -> index % (2 * GRANULE)
u3 -> index % (4 * GRANULE)
u4 -> index % (8 * GRANULE)

i1 -> index % (4 * GRANULE)

s1 -> clickhouse {index % (8 * GRANULE)}
s2 -> clickhouse {index % (16 * GRANULE)}
s2 -> {index % (64 * GRANULE)}
heavy -> large string

Queries:

Run every query for: no prewhere, prewhere old algo, prewhere new algo + tdigest, prewhere new algo + tdigest granule

1) u* + heavy
<>
new <> optimization

different segments
...

2) u* + i* + heavy
= 
u1 vs i1 (better ranks optimization)
u3 vs i1 (similar optimization)

3) s* + heavy
=
new string optimization

4) s4 + u1 + heavy
better string selevivity

5) tdigest vs granule tdigest

u1 + s1 + heavy
on equal

!No compression
!Drop page cache
